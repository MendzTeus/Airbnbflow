import{c as B,y as I,X as D,V as M,r as n,j as e,G as c,Y as z,T as V,Z as E,_ as O,$ as m,H as f,w as N,J as Q,K as U,a0 as $,Q as F,U as H,L as v}from"./index-CFBfUQr5.js";import{P as _}from"./progress-BMeFLOzC.js";import{S as q}from"./skeleton-CFnampVp.js";import{P as G}from"./plus-Cvcf7KTe.js";import{C as J}from"./clipboard-check-DYPUPOyH.js";import{B as K}from"./building-acADVoMY.js";import{C as R}from"./calendar-LSReFn13.js";import{U as X}from"./user-CxJjl2ik.js";import{S as Y}from"./square-pen-2UOtia5C.js";import{T as Z}from"./trash-2-DDAci78G.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=B("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);function oe(){const{hasPermission:x}=I(),w=D(),{checklists:l,properties:C,employees:y,removeChecklist:b}=M(),[T,u]=n.useState(!0),[d,S]=n.useState(""),[h,P]=n.useState("all");n.useEffect(()=>{if(Object.keys(l).length>0)u(!1);else{const s=setTimeout(()=>{Object.keys(l).length===0&&u(!1)},1500);return()=>clearTimeout(s)}},[l]);const A=Object.values(l),g=C,j=y,k=s=>{if(s.items.length===0)return 0;const t=s.items.filter(a=>a.completed).length;return Math.round(t/s.items.length*100)},p=A.filter(s=>h==="completed"?!!s.completedAt:h==="pending"?!s.completedAt:!0).filter(s=>{const t=g[s.propertyId],a=s.assignedTo?j[s.assignedTo]:null;return[s.title,t==null?void 0:t.name,t==null?void 0:t.address,t==null?void 0:t.city,a==null?void 0:a.name].filter(Boolean).join(" ").toLowerCase().includes(d.toLowerCase())}),L=async s=>{try{await b(s)}catch(t){console.error(t)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Checklists"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage cleaning and maintenance checklists for your properties"})]}),x("create:checklist")&&e.jsxs(c,{onClick:()=>w("/checklists/new"),children:[e.jsx(G,{className:"mr-2 h-4 w-4"})," Add Checklist"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative w-full sm:w-auto",children:[e.jsx(z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(V,{placeholder:"Search checklists...",className:"pl-8 w-full sm:w-[300px]",value:d,onChange:s=>S(s.target.value)})]}),e.jsx(E,{defaultValue:"all",className:"w-[300px]",onValueChange:s=>P(s),children:e.jsxs(O,{className:"grid w-full grid-cols-3",children:[e.jsx(m,{value:"all",children:"All"}),e.jsx(m,{value:"pending",children:"Pending"}),e.jsx(m,{value:"completed",children:"Completed"})]})})]}),T?e.jsx("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3",children:[...Array(3)].map((s,t)=>e.jsx(f,{className:"h-[220px] animate-pulse",children:e.jsx(q,{className:"h-full w-full"})},t))}):p.length===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx(J,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("h3",{className:"mt-2 text-lg font-semibold",children:"No checklists found"}),e.jsx("p",{className:"text-muted-foreground",children:d?"Try adjusting your search terms":"Add a checklist to get started"})]}):e.jsx("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3",children:p.map(s=>{const t=g[s.propertyId],a=s.assignedTo?j[s.assignedTo]:null,o=k(s),r=!!s.completedAt;return e.jsxs(f,{className:N(r&&"bg-muted/30 border-muted"),children:[e.jsx(Q,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(U,{className:"text-lg",children:s.title}),t&&e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground mt-1",children:[e.jsx(K,{className:"mr-1 h-3.5 w-3.5"}),e.jsx("span",{children:t.name})]})]}),e.jsx($,{variant:r?"outline":"default",children:r?"Completed":"Pending"})]})}),e.jsx(F,{className:"pb-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progress"}),e.jsxs("span",{children:[o,"%"]})]}),e.jsx(_,{value:o,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{className:"mr-1 h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:new Date(s.createdAt).toLocaleDateString()})]}),a&&e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx(X,{className:"mr-1 h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground truncate max-w-[100px]",children:a.name})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Items:"}),e.jsxs("ul",{className:"space-y-1",children:[s.items.slice(0,3).map(i=>e.jsxs("li",{className:"flex items-center text-sm",children:[e.jsx(W,{className:N("mr-2 h-4 w-4",i.completed?"text-primary":"text-muted-foreground/40")}),e.jsx("span",{className:i.completed?"text-muted-foreground line-through":"",children:i.text})]},i.id)),s.items.length>3&&e.jsxs("li",{className:"text-sm text-muted-foreground pl-6",children:["+",s.items.length-3," more items"]})]})]})]})}),e.jsx(H,{className:"pt-4",children:e.jsxs("div",{className:"flex justify-between w-full",children:[e.jsx(v,{to:`/checklists/${s.id}`,children:e.jsx(c,{variant:"outline",size:"sm",children:"View Details"})}),x("edit:checklist")&&!r&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{to:`/checklists/${s.id}/edit`,children:e.jsx(c,{variant:"outline",size:"icon",className:"h-8 w-8",children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(c,{variant:"outline",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>L(s.id),children:e.jsx(Z,{className:"h-4 w-4"})})]})]})})]},s.id)})})]})}export{oe as default};
